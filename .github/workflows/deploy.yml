# ===================================
# Code Keeper Bot - CI/CD Pipeline
# ×‘×•×˜ ×©×•××¨ ×§×‘×¦×™ ×§×•×“ - ×¤×™×™×¤×œ×™×™×Ÿ ××•×˜×•××˜×™
# ===================================

name: ğŸš€ Code Keeper Bot CI/CD

on:
  # ×”×¤×¢×œ×” ×¢×œ push ×œ×¢× ×¤×™× ×¢×™×§×¨×™×™× ×‘×œ×‘×“ (×œ× PR)
  push:
    branches: [ main, develop ]
    tags: [ 'v*' ]

  # ×”×¤×¢×œ×” ×™×“× ×™×ª
  workflow_dispatch:
    inputs:
      environment:
        description: 'Target environment'
        required: true
        default: 'staging'
        type: choice
        options:
          - staging
          - production

# ××©×ª× ×™ ×¡×‘×™×‘×” ×’×œ×•×‘×œ×™×™×
env:
  PYTHON_VERSION: '3.11'
  NODE_VERSION: '18'
  REGISTRY: ghcr.io
  IMAGE_NAME: ${{ github.repository }}

# ×”×¨×©××•×ª GITHUB_TOKEN
permissions:
  contents: read
  packages: write
  security-events: write
  issues: write
  pull-requests: write

jobs:
  # ===================================
  # ×©×œ×‘ 1: ×‘×“×™×§×•×ª ×§×•×“
  # ===================================
  code-quality:
    name: ğŸ” Code Quality & Security
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      
      - name: ğŸ Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: ${{ env.PYTHON_VERSION }}
          cache: 'pip'
      
      - name: ğŸ“¦ Install Dependencies
        run: |
          python -m pip install --upgrade pip
          pip install wheel poetry-core
          pip install -r requirements.txt
          pip install flake8 black isort mypy bandit safety pytest pytest-asyncio pytest-cov
      
      - name: ğŸ” Dependency integrity (pip check)
        run: |
          pip check

      - name: ğŸ§ª Smoke compile (exclude .restore)
        run: |
          find . -type f -name "*.py" -not -path "./.restore/*" -print0 | xargs -0 -n1 -P 4 python -m py_compile
      
      - name: ğŸ¨ Code Formatting (Black)
        run: |
          black --check --diff .
        continue-on-error: true
      
      - name: ğŸ“‹ Import Sorting (isort)
        run: |
          isort --check-only --diff .
        continue-on-error: true
      
      - name: ğŸ” Linting (Flake8)
        run: |
          flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics
          flake8 . --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics
      
      - name: ğŸ·ï¸ Type Checking (MyPy)
        run: |
          mypy . --ignore-missing-imports
        continue-on-error: true
      
      - name: ğŸ”’ Security Check (Bandit)
        run: |
          bandit -r . -f json -o bandit-report.json
        continue-on-error: true
      
      - name: ğŸ›¡ï¸ Dependency Check (Safety)
        run: |
          safety check --json --output safety-report.json
        continue-on-error: true
      
      - name: ğŸ“Š Upload Security Reports
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: security-reports
          path: |
            bandit-report.json
            safety-report.json

  # ===================================
  # ×©×œ×‘ 2: ×‘×“×™×§×•×ª ×™×—×™×“×”
  # ===================================
  unit-tests:
    name: ğŸ§ª Unit Tests
    runs-on: ubuntu-latest
    needs: code-quality
    
    strategy:
      matrix:
        python-version: ['3.9', '3.10', '3.11']
    
    services:
      mongodb:
        image: mongo:6.0
        env:
          MONGO_INITDB_ROOT_USERNAME: test
          MONGO_INITDB_ROOT_PASSWORD: test123
        ports:
          - 27017:27017
        options: >-
          --health-cmd "echo 'db.runCommand(\"ping\").ok' | mongosh localhost:27017/test --quiet"
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
      
      redis:
        image: redis:7-alpine
        ports:
          - 6379:6379
        options: >-
          --health-cmd "redis-cli ping"
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
    
    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4
      
      - name: ğŸ Setup Python ${{ matrix.python-version }}
        uses: actions/setup-python@v4
        with:
          python-version: ${{ matrix.python-version }}
          cache: 'pip'
      
      - name: ğŸ“¦ Install Dependencies
        run: |
          python -m pip install --upgrade pip
          pip install wheel poetry-core
          pip install -r requirements.txt
          pip install pytest pytest-asyncio pytest-cov pytest-mock

      - name: ğŸ” Dependency integrity (pip check)
        run: |
          pip check

        
      - name: ğŸ§ª Smoke compile (exclude .restore)
        run: |
          find . -type f -name "*.py" -not -path "./.restore/*" -print0 | xargs -0 -n1 -P 4 python -m py_compile
      
      - name: ğŸ§ª Run Tests
        env:
          BOT_TOKEN: ${{ secrets.TEST_BOT_TOKEN || '1234567890:TEST_TOKEN_FOR_TESTING' }}
          MONGODB_URL: mongodb://test:test123@localhost:27017/test_db?authSource=admin
          REDIS_URL: redis://localhost:6379/0
          GITHUB_TOKEN: ${{ secrets.TEST_GITHUB_TOKEN }}
          PASTEBIN_API_KEY: ${{ secrets.TEST_PASTEBIN_KEY }}
        run: |
          pytest -v --cov=. --cov-report=xml --cov-report=html
      
      # Coverage upload ××‘×•×¦×¢ ×›×‘×¨ ×‘-CI ×”×¨××©×™. ×›×“×™ ×œ×× ×•×¢ ×›×¤×™×œ×•×™×•×ª/×‘×œ×‘×•×œ, × × ×˜×¨×œ ×›××Ÿ.
      - name: ğŸ“Š Upload Coverage to Codecov (disabled - handled in CI workflow)
        if: false
        uses: codecov/codecov-action@v4
        with:
          files: ./coverage.xml
          flags: unittests
          name: codecov-umbrella
      
      - name: ğŸ“ˆ Upload Coverage Reports
        uses: actions/upload-artifact@v4
        if: matrix.python-version == '3.11'
        with:
          name: coverage-reports
          path: htmlcov/

  # Aggregator to expose a single required status for all matrix runs
  unit-tests-gate:
    name: ğŸ§ª Unit Tests
    runs-on: ubuntu-latest
    needs: [unit-tests]
    if: github.event_name == 'pull_request'
    steps:
      - name: All unit test matrix runs succeeded
        run: echo "All unit test matrix runs succeeded"

  # ===================================
  # ×©×œ×‘ 3: ×‘× ×™×™×ª Docker Images
  # ===================================
  build-docker:
    name: ğŸ³ Build Docker Images
    runs-on: ubuntu-latest
    needs: [code-quality, unit-tests]
    timeout-minutes: 45
    
    outputs:
      image-digest: ${{ steps.build.outputs.digest }}
      image-tag: ${{ steps.meta.outputs.tags }}
    
    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4
      
      - name: ğŸ§­ Determine build plan (platforms & push)
        id: plan
        run: |
          set -euo pipefail
          if [[ "${GITHUB_REF}" == refs/tags/v* ]]; then
            echo "platforms=linux/amd64,linux/arm64" >> "$GITHUB_OUTPUT"
            echo "do_push=true" >> "$GITHUB_OUTPUT"
          elif [[ "${GITHUB_EVENT_NAME}" == "push" && ( "${GITHUB_REF}" == "refs/heads/main" || "${GITHUB_REF}" == "refs/heads/develop" ) ]]; then
            echo "platforms=linux/amd64" >> "$GITHUB_OUTPUT"
            echo "do_push=true" >> "$GITHUB_OUTPUT"
          else
            echo "platforms=linux/amd64" >> "$GITHUB_OUTPUT"
            echo "do_push=false" >> "$GITHUB_OUTPUT"
          fi
      
      - name: ğŸ§ Set up QEMU (for ARM emulation)
        uses: docker/setup-qemu-action@v3
        with:
          platforms: arm64
      
      - name: ğŸ”§ Set up Docker Buildx
        uses: docker/setup-buildx-action@v3
      
      - name: ğŸ” Login to Container Registry
        if: ${{ steps.plan.outputs.do_push == 'true' }}
        uses: docker/login-action@v3
        with:
          registry: ${{ env.REGISTRY }}
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}
      
      - name: ğŸ·ï¸ Extract Metadata
        id: meta
        uses: docker/metadata-action@v5
        with:
          images: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}
          tags: |
            type=ref,event=branch
            type=ref,event=pr
            type=semver,pattern={{version}}
            type=semver,pattern={{major}}.{{minor}}
            type=semver,pattern={{major}}
            # Avoid generating tags with empty names
            type=sha,prefix=sha-
            type=raw,value=latest,enable={{is_default_branch}}
      
      - name: ğŸ—ï¸ Build and Push Docker Image
        id: build
        uses: docker/build-push-action@v5
        with:
          context: .
          platforms: ${{ steps.plan.outputs.platforms }}
          push: ${{ steps.plan.outputs.do_push == 'true' }}
          load: ${{ steps.plan.outputs.do_push != 'true' }}
          tags: ${{ steps.meta.outputs.tags }}
          labels: ${{ steps.meta.outputs.labels }}
          cache-from: type=gha
          cache-to: type=gha,mode=max
          target: production
      
      - name: â³ Wait for image to be available in registry
        if: ${{ steps.plan.outputs.do_push == 'true' }}
        run: sleep 15
      
      - name: ğŸ›¡ï¸ Run Security Scan
        if: ${{ steps.plan.outputs.do_push == 'true' }}
        uses: aquasecurity/trivy-action@master
        with:
          image-ref: ${{ steps.build.outputs.digest }}
          format: 'sarif'
          output: 'trivy-results.sarif'
        continue-on-error: true

      - name: Check if SARIF exists
        id: has_trivy_sarif
        run: |
          if [ -f trivy-results.sarif ]; then
            echo "exists=true" >> "$GITHUB_OUTPUT"
          else
            echo "exists=false" >> "$GITHUB_OUTPUT"
          fi

      - name: ğŸ“Š Upload Security Scan Results
        if: steps.has_trivy_sarif.outputs.exists == 'true'
        uses: github/codeql-action/upload-sarif@v3
        with:
          sarif_file: 'trivy-results.sarif'

  # ×©×œ×‘ 3.5: (×‘×•×˜×œ) â€” ×”×©×ª××© ×™×©×™×¨×•×ª ×‘×‘×“×™×§×•×ª Code Quality & Security ×•â€‘Unit Tests

  # ===================================
  # ×©×œ×‘ 4: ×¤×¨×™×¡×” ×œ-Render Staging
  # ===================================
  deploy-staging:
    name: ğŸš€ Deploy to Render Staging
    runs-on: ubuntu-latest
    needs: build-docker
    if: github.ref == 'refs/heads/develop' || github.event.inputs.environment == 'staging'
    
    environment:
      name: staging
      url: https://code-keeper-bot-staging.onrender.com
    
    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4
      
      - name: ğŸš€ Trigger Render Deploy (Staging)
        run: |
          curl -X POST "${{ secrets.RENDER_STAGING_DEPLOY_HOOK }}" \
            -H "Content-Type: application/json" \
            -d '{
              "branch": "develop",
              "commit": "${{ github.sha }}"
            }'
      
      - name: â³ Wait for Deployment
        run: |
          echo "â³ Waiting for Render deployment to complete..."
          sleep 120  # ×××ª×™×Ÿ 2 ×“×§×•×ª ×œ×¤×¨×™×¡×”
      
      - name: ğŸ§ª Health Check
        run: |
          echo "ğŸ¥ Checking staging health..."
          for i in {1..10}; do
            if curl -f "https://code-keeper-bot-staging.onrender.com/health" 2>/dev/null; then
              echo "âœ… Staging is healthy!"
              exit 0
            fi
            echo "â³ Attempt $i/10 failed, waiting 30s..."
            sleep 30
          done
          echo "âŒ Staging health check failed"
          exit 1
      
      - name: ğŸ§ª Integration Tests
        run: |
          echo "ğŸ§ª Running integration tests against staging..."
          # ×›××Ÿ × ×•×¡×™×£ ×‘×“×™×§×•×ª ××™× ×˜×’×¨×¦×™×” ×¡×¤×¦×™×¤×™×•×ª
          python -c "
          import requests
          import os
          
          # ×‘×“×™×§×” ×©×”×‘×•×˜ ××’×™×‘
          staging_url = 'https://code-keeper-bot-staging.onrender.com'
          
          try:
              response = requests.get(f'{staging_url}/health', timeout=10)
              assert response.status_code == 200
              print('âœ… Staging API is responding')
              
              # ×‘×“×™×§×•×ª × ×•×¡×¤×•×ª ×›××Ÿ...
              
          except Exception as e:
              print(f'âŒ Integration test failed: {e}')
              exit(1)
          "

  # ===================================
  # ×©×œ×‘ 5: ×¤×¨×™×¡×” ×œ-Render Production
  # ===================================
  deploy-production:
    name: ğŸ­ Deploy to Render Production
    runs-on: ubuntu-latest
    needs: [build-docker, deploy-staging]
    if: github.ref == 'refs/heads/main' || startsWith(github.ref, 'refs/tags/v') || github.event.inputs.environment == 'production'
    
    environment:
      name: production
      url: https://code-keeper-bot.onrender.com
    
    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4
      
      - name: ğŸ¯ Create GitHub Release
        if: startsWith(github.ref, 'refs/tags/v')
        uses: actions/create-release@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          tag_name: ${{ github.ref_name }}
          release_name: Release ${{ github.ref_name }}
          body: |
            ## ğŸš€ Code Keeper Bot ${{ github.ref_name }}
            
            ### âœ¨ New Features
            - Feature 1
            - Feature 2
            
            ### ğŸ› Bug Fixes
            - Fix 1
            - Fix 2
            
            ### ğŸ“¦ Docker Image
            ```bash
            docker pull ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:${{ github.ref_name }}
            ```
            
            ### ğŸŒ Live on Render
            The bot is deployed and running at: https://code-keeper-bot.onrender.com
            
            ### ğŸ”— Full Changelog
            https://github.com/${{ github.repository }}/compare/${{ github.event.before }}...${{ github.ref_name }}
          draft: false
          prerelease: false
      
      - name: ğŸš€ Trigger Render Deploy (Production)
        run: |
          echo "ğŸš€ Deploying to Render Production..."
          
          # ×§×¨×™××” ×œ-Render Deploy Hook
          response=$(curl -s -w "%{http_code}" -X POST "${{ secrets.RENDER_PRODUCTION_DEPLOY_HOOK }}" \
            -H "Content-Type: application/json" \
            -d "{
              \"branch\": \"main\",
              \"commit\": \"${{ github.sha }}\",
              \"message\": \"Automated deployment from GitHub Actions\"
            }")
          
          http_code="${response: -3}"
          
          if [ "$http_code" -eq 200 ] || [ "$http_code" -eq 201 ]; then
            echo "âœ… Render deployment triggered successfully"
          else
            echo "âŒ Failed to trigger Render deployment (HTTP: $http_code)"
            exit 1
          fi
      
      - name: â³ Wait for Production Deployment
        run: |
          echo "â³ Waiting for Render production deployment..."
          
          # ×”××ª× ×” ××•×ª×××ª ×œ×’×•×“×œ ×”×¤×¨×•×™×§×˜
          echo "â³ Build and deployment typically takes 3-5 minutes on Render..."
          sleep 180  # 3 ×“×§×•×ª
          
          # ×‘×“×™×§×” ×©×”×©×™×¨×•×ª ×¢×œ×”
          for i in {1..20}; do
            if curl -f "https://code-keeper-bot.onrender.com/health" 2>/dev/null; then
              echo "âœ… Production deployment successful!"
              break
            fi
            
            if [ $i -eq 20 ]; then
              echo "âŒ Production deployment timeout"
              exit 1
            fi
            
            echo "â³ Deployment check $i/20, waiting 30s..."
            sleep 30
          done
      
      - name: ğŸ“Š Production Health Check
        run: |
          echo "ğŸ¥ Running comprehensive production health checks..."
          
          production_url="https://code-keeper-bot.onrender.com"
          
          # ×‘×“×™×§×•×ª ×‘×¡×™×¡×™×•×ª
          echo "ğŸ” Testing basic connectivity..."
          curl -f "$production_url/health" || exit 1
          
          # ×‘×“×™×§×ª response time
          echo "âš¡ Testing response time..."
          response_time=$(curl -w "%{time_total}" -s -o /dev/null "$production_url/health")
          
          if (( $(echo "$response_time > 5.0" | bc -l) )); then
            echo "âš ï¸ Warning: Slow response time ($response_time seconds)"
          else
            echo "âœ… Good response time: $response_time seconds"
          fi
          
          echo "âœ… All production health checks passed!"
      
      - name: ğŸ”„ Rollback on Failure
        if: failure()
        run: |
          echo "âŒ Production deployment failed, attempting rollback..."
          
          # ×× ×™×© deploy hook ×œ×’×¨×¡×” ×§×•×“××ª, × ×©×ª××© ×‘×•
          if [ -n "${{ secrets.RENDER_ROLLBACK_HOOK }}" ]; then
            curl -X POST "${{ secrets.RENDER_ROLLBACK_HOOK }}"
            echo "ğŸ”„ Rollback triggered"
          else
            echo "âš ï¸ No rollback hook configured"
          fi

  # ===================================
  # ×©×œ×‘ 6: ×”×ª×¨××•×ª
  # ===================================
#  notify:
#    name: ğŸ“¢ Notifications
#    runs-on: ubuntu-latest
#    needs: [deploy-staging, deploy-production]
#    if: always()
#    
#    steps:
#      - name: ğŸ“± Telegram Notification
#        if: always()
#        uses: appleboy/telegram-action@master
#        with:
#          to: ${{ secrets.TELEGRAM_CHAT_ID }}
#          token: ${{ secrets.TELEGRAM_BOT_TOKEN }}
#          message: |
#            ğŸ¤– **Code Keeper Bot Deployment**
#            
#            ğŸ“‹ **Workflow:** ${{ github.workflow }}
#            ğŸŒ¿ **Branch:** ${{ github.ref_name }}
#            ğŸ‘¤ **Actor:** ${{ github.actor }}
#            ğŸ’¾ **Commit:** ${{ github.sha }}
#            
#            ğŸ“Š **Results:**
#            â€¢ Code Quality: ${{ needs.code-quality.result }}
#            â€¢ Unit Tests: ${{ needs.unit-tests.result }}
#            â€¢ Docker Build: ${{ needs.build-docker.result }}
#            â€¢ Staging: ${{ needs.deploy-staging.result }}
#            â€¢ Production: ${{ needs.deploy-production.result }}
#            
#            ğŸ”— **Details:** https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}
#      
#      - name: ğŸ“§ Email Notification
#        if: failure()
#        uses: dawidd6/action-send-mail@v3
#        with:
#          server_address: ${{ secrets.SMTP_HOST }}
#          server_port: ${{ secrets.SMTP_PORT }}
#          username: ${{ secrets.SMTP_USER }}
#          password: ${{ secrets.SMTP_PASSWORD }}
#          subject: "âŒ Code Keeper Bot Deployment Failed"
#          to: ${{ secrets.NOTIFICATION_EMAIL }}
#          from: "CI/CD <noreply@codekeeper.bot>"
#          html_body: |
#            <h2>âŒ Deployment Failed</h2>
#            <p><strong>Repository:</strong> ${{ github.repository }}</p>
#            <p><strong>Branch:</strong> ${{ github.ref_name }}</p>
#            <p><strong>Commit:</strong> ${{ github.sha }}</p>
#            <p><strong>Actor:</strong> ${{ github.actor }}</p>
#            <p><a href="https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}">View Details</a></p>

  # ===================================
  # ×©×œ×‘ 7: × ×™×§×•×™
  # ===================================
  cleanup:
    name: ğŸ§¹ Cleanup
    runs-on: ubuntu-latest
    # needs: [notify]
    needs: [deploy-staging, deploy-production]
    if: always()
    
    steps:
      - name: ğŸ”‘ Resolve Packages Token (PAT fallback)
        id: pkg-token
        shell: bash
        run: |
          if [ -n "${{ secrets.PACKAGES_PAT }}" ]; then
            echo "token=${{ secrets.PACKAGES_PAT }}" >> "$GITHUB_OUTPUT"
          else
            echo "token=${{ github.token }}" >> "$GITHUB_OUTPUT"
          fi
      - name: ğŸ—‘ï¸ Delete Old Images
        uses: actions/delete-package-versions@v4
        env:
          GITHUB_TOKEN: ${{ steps.pkg-token.outputs.token }}
        with:
          owner: ${{ github.repository_owner }}
          package-name: ${{ github.event.repository.name }}
          package-type: 'container'
          min-versions-to-keep: 10
          delete-only-untagged-versions: true
      
      - name: ğŸ“Š Collect Metrics
        run: |
          echo "ğŸ“Š Collecting deployment metrics..."
          # ×›××Ÿ × ×•×¡×™×£ ××™×¡×•×£ ××˜×¨×™×§×•×ª ×œ×¦×•×¨×›×™ × ×™×˜×•×¨

## ===================================
## Workflow × ×•×¡×£: Security Scanning ×”×•×¢×‘×¨ ×œ×§×•×‘×¥ × ×¤×¨×“
## ===================================

## ===================================
## Workflow × ×•×¡×£: Performance Testing ×”×•×¢×‘×¨ ×œ×§×•×‘×¥ × ×¤×¨×“
## ===================================

# ===================================
# ×”×•×¨××•×ª ×”×’×“×¨×” ×‘-GitHub + Render
# ===================================

# Secrets × ×“×¨×©×™× ×‘-GitHub Repository Settings â†’ Secrets:

# ×¢×‘×•×¨ ×‘×“×™×§×•×ª:
# - TEST_BOT_TOKEN: ×˜×•×§×Ÿ ×‘×•×˜ ×œ×‘×“×™×§×•×ª
# - TEST_GITHUB_TOKEN: ×˜×•×§×Ÿ GitHub ×œ×‘×“×™×§×•×ª  
# - TEST_PASTEBIN_KEY: ××¤×ª×— Pastebin ×œ×‘×“×™×§×•×ª

# ×¢×‘×•×¨ Render deployment:
# - RENDER_STAGING_DEPLOY_HOOK: Render deploy hook URL ×œstaging
# - RENDER_PRODUCTION_DEPLOY_HOOK: Render deploy hook URL ×œproduction
# - RENDER_ROLLBACK_HOOK: Render rollback hook (××•×¤×¦×™×•× ×œ×™)

# ×¢×‘×•×¨ ×”×ª×¨××•×ª:
# - TELEGRAM_CHAT_ID: ID ×¦'××˜ ×œ×”×ª×¨××•×ª
# - TELEGRAM_BOT_TOKEN: ×˜×•×§×Ÿ ×‘×•×˜ ×œ×”×ª×¨××•×ª
# - NOTIFICATION_EMAIL: ××™××™×™×œ ×œ×”×ª×¨××•×ª
# - SMTP_HOST, SMTP_PORT, SMTP_USER, SMTP_PASSWORD: ×”×’×“×¨×•×ª SMTP

# ===================================
# ×”×’×“×¨×ª Deploy Hooks ×‘-Render:
# ===================================

# 1. ×¢×‘×•×¨ ×œRender Dashboard
# 2. ×‘×—×¨ ××ª ×”×©×™×¨×•×ª ×©×œ×š
# 3. ×¢×‘×•×¨ ×œ-Settings â†’ Deploy Hooks
# 4. ×¦×•×¨ deploy hook ×—×“×©
# 5. ×”×¢×ª×§ ××ª ×”-URL
# 6. ×”×•×¡×£ ×›Secret ×‘-GitHub

# ===================================
# Environment Variables ×‘-Render:
# ===================================

# ×‘-Render Service Settings â†’ Environment:
# BOT_TOKEN=your_telegram_bot_token
# MONGODB_URL=mongodb+srv://user:pass@cluster.mongodb.net/dbname
# GITHUB_TOKEN=your_github_token (××•×¤×¦×™×•× ×œ×™)
# PASTEBIN_API_KEY=your_pastebin_key (××•×¤×¦×™×•× ×œ×™)
# LOG_LEVEL=INFO
# SENTRY_DSN=your_sentry_dsn (××•×¤×¦×™×•× ×œ×™)

# ===================================
# MongoDB Atlas Setup:
# ===================================

# 1. ×¢×‘×•×¨ ×œ-https://cloud.mongodb.com
# 2. ×¦×•×¨ ×—×©×‘×•×Ÿ ×•-cluster ×—×™× ××™
# 3. ×”×’×“×¨ Network Access â†’ Allow Access From Anywhere
# 4. ×¦×•×¨ DB User ×¢× read/write permissions
# 5. ×§×‘×œ connection string ×•×©×™× ×‘-MONGODB_URL

# ===================================
# Render Auto-Deploy Setup:
# ===================================

# Render ×™×¤×¨×•×¡ ××•×˜×•××˜×™×ª ×›×œ push ×œ-main
# ×œ× ×¦×¨×™×š SSH keys ××• server management!
# ×¤×©×•×˜ push ×œ-GitHub ×•×”×›×œ ×™×§×¨×” ××•×˜×•××˜×™×ª ğŸš€
